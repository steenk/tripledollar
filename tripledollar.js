/* tripledollar v.1.1.1, (c) 2015 Steen Klingberg. License MIT. */
(function(e){"use strict";var t="1.1.1",n={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},i=function(e,t){var n=e.length,i=[""],r=0,s=0,o=0;while(r<n){if(e[r]==="."||e[r]==="#"){if(t){i[s++]=e[r]}else{i[o++]=e.slice(s,r);s=r+1}}r++;if(!t&&r===n){i[o++]=e.slice(s)}}return i},r=function(t){var s=Array.prototype.slice.call(arguments,1),o,l,a,c,f,u=[],d,p=/^[A-Za-z][A-Za-z0-9-_\.:#]*$/;if(typeof t!=="string"){if(Object.prototype.toString.call(t)==="[object Array]"){return r.apply(this,t)}else if(t instanceof e.HTMLElement||t instanceof e.SVGElement){t.evt=v;t.set=m;t.fun=g;t.ins=A;t.css=y;t.query=t.querySelector;t.queryAll=t.querySelectorAll;t.prototype=t;return t}else return}if(t&&!p.test(t)){console.log('$$$: not a valid ident parameter "'+t+'".');return}o=i(t,false);l=i(t,true);for(c=0;c<o.length;c++){if(o[c]&&!p.test(o[c])){return}if(c===0){f=o[0].split(":");if(n[f[0]]){a=e.document.createElementNS(n[f[0]],f[1]||f[0])}else{a=e.document.createElement(f[1]||f[0])}}else{if(a&&l[c-1]==="."){u.push(o[c])}else if(l[c-1]==="#"){a.setAttribute("id",o[c])}}if(u.length>0){a.setAttribute("class",u.join(" "))}}function h(t){var i,s,o,l,a;for(s=0;s<t.length;s++){i=t[s];if(i&&i.nodeType){this.appendChild(i)}else if(typeof i==="object"){if(Object.prototype.toString.call(i)==="[object Array]"){this.appendChild(r.apply(this,i))}else{for(l in i){if(i.hasOwnProperty(l)){if(/^data[A-Z]/.test(l)){a=l.substr(4).toLowerCase();this.setAttribute("data-"+a,i[l])}else{o=l.split(":");if(o.length===2&&Object.keys(n).indexOf(o[0])>-1){this.setAttributeNS(n[o[0]],o[1],i[l])}else{this.setAttribute(l,i[l])}}}}}}else{this.appendChild(e.document.createTextNode(String(i)))}}}h.call(a,s);function y(e){var t,n,i;for(t in e){if(e.hasOwnProperty(t)){if(typeof e[t]!=="object"){this.style[t]=e[t]}else{n=this.querySelectorAll(t);for(i=0;i<n.length;i++){y.call(n[i],e[t])}}}}return this}a.css=y;function m(e,t){this[e]=t;return this}a.set=m;function g(e){var t=Array.prototype.slice.call(arguments,1);this[e].apply(this,t);return this}a.fun=g;function v(e,t){if(arguments.length>2){var n=Array.prototype.slice.call(arguments,2);if(this.addEventListener){this.addEventListener(e,function(e){var i=[e].concat(n);t.apply(this,i)},false)}else{this.attachEvent("on"+e,function(e){var i=[e].concat(n);t.apply(this,i)})}}else{if(this.addEventListener){this.addEventListener(e,t,false)}else{this.attachEvent("on"+e,t)}}return this}a.evt=v;function A(){h.call(this,Array.prototype.slice.call(arguments));return this}a.ins=A;a.query=a.querySelector;a.queryAll=a.querySelectorAll;a.prototype=a;return a},s,o,l,a;r.version=t;r.structify=function(e,t){var n=null,i;if(e.nodeType===1){i=function(e){var n=[],r,s,o,l,a,c=/id|class|contenteditable/,f=e.localName,u=String(e.getAttribute("class")||"").replace(/\s/g,".");if(u){f+="."+u}if(e.id){f+="#"+e.id}n.push(f);if(e.hasAttributes()){s=e.attributes;r={};for(a=0;a<s.length;a++){if(!c.test(s[a].name)){r[s[a].name]=s[a].value}}if(Object.keys(r).length>0){n.push(r)}}e.normalize();o=e.childNodes;for(a=0;a<o.length;a++){if(o[a].nodeType===3){if(t){l=o[a].data.replace(/\s\s*/," ").trim()}else{l=o[a].data}if(l.length>0){n.push(l)}}else if(o[a].nodeType===1){n.push(i(o[a]))}}return n};n=i(e)}return n};r.onReady=function(t){if(e.document.readyState==="complete"||e.document.readyState==="interactive"){s(t)}else if(e.document.addEventListener){e.document.addEventListener("DOMContentLoaded",t,false)}else{e.document.attachEvent("onreadystatechange",t)}};if(e.setImmediate){s=e.setImmediate}else{l=[];a="doNext"+(Math.random()*67108864|0).toString(16);o=function(t){var n,i;if(t.source===e&&typeof t.data==="string"&&t.data.indexOf(a)===0){i=l.shift();if(i.length>0){n=i[0].apply(undefined,i.splice(1),true);if(l[0]&&l[0].length===1){l[0].push(n)}}}};if(e.postMessage){if(e.addEventListener){e.addEventListener("message",o,false)}else{e.attachEvent("message",o)}}else{e.postMessage=function(t){e.setTimeout(function(){o({source:e,data:t})},0)}}s=function(){var t=Array.prototype.slice.call(arguments);if(typeof t[0]==="function"){l.push(t);e.postMessage(a,"*")}}}r.setImmediate=s;r.appendToDoc=function c(){var t=Array.prototype.slice.call(arguments),n,i=[];c.then=function(e){if(c===e){throw new TypeError("Circular reference.")}if(typeof e==="function"){i.push(e)}else{console.log('$$$: Only functions can be passed to "then()"!')}return c};c.catch=function(e){console.log("$$$: Error occured.",e);return c};function o(i){var s;r.onReady(function(){for(n=0;n<t.length;n++){if(Object.prototype.toString.call(t[n])==="[object Array]"){s=r.apply(this,t[n]);if(s){e.document.body.appendChild(s)}}else if(t[n]instanceof e.Element){e.document.body.appendChild(t[n])}else if(typeof t[n]==="function"){t[n]()}}i()})}if(typeof Promise!=="undefined"){return new Promise(function(e,t){try{o(e)}catch(n){t(n)}})}else{o(function(){var e;i.forEach(function(t){s(function(){if(e&&e.then){e.then(function(e){t(e)})}else{e=t(e)}})})});return c}};r.query=function(t){return e.document.querySelector(t)};r.queryAll=function(t){return e.document.querySelectorAll(t)};r.destroy=function f(e){if(e){while(e.hasChildNodes()){f(e.firstChild);e.removeChild(e.firstChild)}}};r.namespace=function(e,t){if(t){n[e]=t}return n[e]};if(typeof e.define==="function"){e.define(function(){return r})}else if(typeof module==="object"){module.exports=r}else{e.$$$=r}})(this);